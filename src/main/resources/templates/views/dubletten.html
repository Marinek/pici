<html xmlns:th="https://www.thymeleaf.org">

<head></head>

<body>

	<div th:fragment="content">

		<div class="container-fluid">
			<div class="row">
				<div class="col-md-12">
					<div class="bgc-white bd bdrs-3 p-20 mB-20">
						<h4 class="c-grey-900 mB-20">Doppelte Fotos</h4>
						<table id="myTable" class="table table-striped table-bordered">
							<thead>
								<tr>
									<th>Dateiname</th>
									<th>Verzeichnis</th>
									<th>Aktionen</th>
								</tr>
							</thead>

						</table>
					</div>
				</div>
			</div>

			<script>
				$(document)
						.ready(
								function() {
									$('#myTable')
											.DataTable(
													{
														"processing" : true,
														"serverSide" : true,
														"searching" : false,
														"info" : true,
														"ajax" : {
															"url" : "duplicates",
															"dataSrc" : "content",
															"dataFilter" : function(
																	data) {
																var json = jQuery
																		.parseJSON(data);
																json.recordsTotal = json.totalElements;
																json.recordsFiltered = json.totalElements;
																json.data = json.data;

																return JSON
																		.stringify(json); // return JSON string
															}
														},
														"columns" : [
																{
																	"data" : "fileName",
																	"render" : function(
																			data,
																			type,
																			row) {

																		var renderOutput = '';
																		
																		if (type === 'display') {
																			
																			renderOutput +=  '<img class="bdrs-50p w-3r h-3r" height="50" width="50" src="image/'  + row.id + '"/>';
																				
																			if (row.resolved === true) {
																				renderOutput += '<span class="badge rounded-pill fl-r bg-success lh-0 p-10">Erledigt</span>';
																			}

																			if (row.original === true) {
																				renderOutput += '<span class="badge rounded-pill fl-r  bg-info  lh-0 p-10">Original</span>';
																			}
																		}

																		return renderOutput + '&nbsp' + data;
																	}

																},
																{
																	"data" : "directory.pathName"
																},
																{
																	"data" : "id",
																	render : function(
																			data,
																			type) {
																		if (type === 'display') {

																			return '<button type="button" onclick="setOriginal('+data+')" class="btn cur-p btn-success btn-color">Original</button>';
																		}

																		return data;
																	}
																} ]

													});
								});
				
						function setOriginal(data)	{
							 $.ajax({url: "dubletten/original/" + data, success: function(result){
								 $('#myTable').DataTable().ajax.reload(null, false)
								  }});
							 
							 return false;
						}
			</script>
		</div>

	</div>
</body>
</html>